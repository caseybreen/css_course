<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="">
<meta name="dcterms.date" content="2025-01-20">

<title>Topics in Computational Social Science - Lab 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="css_lab1_files/libs/clipboard/clipboard.min.js"></script>
<script src="css_lab1_files/libs/quarto-html/quarto.js"></script>
<script src="css_lab1_files/libs/quarto-html/popper.min.js"></script>
<script src="css_lab1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="css_lab1_files/libs/quarto-html/anchor.min.js"></script>
<link href="css_lab1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="css_lab1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="css_lab1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="css_lab1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="css_lab1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Topics in Computational Social Science - Lab 1</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p><your name="" here=""> </your></p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 20, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="lab-1---querying-fb-marketing-api" class="level1">
<h1>Lab 1 - Querying FB Marketing API</h1>
<p>In this lab, we’ll explore how to obtain FB monthly active user counts broken down by geography, gender, and age. These aggregate FB data can be used to study topics such as migration or digital inequality. Here are some motivating examples of papers that use these data:</p>
<ul>
<li><p>Fatehkia, Masoomali, Ridhi Kashyap, and Ingmar Weber. 2018. ‘Using Facebook Ad Data to Track the Global Digital Gender Gap’. <em>World Development</em> 107:189–209. doi: <a href="https://doi.org/10.1016/j.worlddev.2018.03.007">10.1016/j.worlddev.2018.03.007</a>.</p></li>
<li><p>Rampazzo, Francesco, Jakub Bijak, Agnese Vitali, Ingmar Weber, and Emilio Zagheni. 2021. ‘A Framework for Estimating Migrant Stocks Using Digital Traces and Survey Data: An Application in the United Kingdom’. <em>Demography</em> 58(6):2193–2218. doi: <a href="https://doi.org/10.1215/00703370-9578562">10.1215/00703370-9578562</a>.</p></li>
</ul>
<p>To query the Facebook Marketing API (Application Program Interface), we’ll use using <code>rsocialwatcher</code> package. This software package facilitates querying the marketing API. At a high-level, the package will allow you to give your credentials and some target population (e.g., women aged 15-49 in France). The package then queries the API and returns a dataframe containing the number of Facebook monthly active users for the specified audience.</p>
<p>You’ll need to install and library the <code>rsocialwatcher</code> package before working through the lab using the <code>install.packages("&lt;package_name&gt;")</code> command.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Uncomment below line if you haven't installed rsocialwatcher or tidyverse package </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("rsocialwatcher")</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("tidyverse")</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rsocialwatcher)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Set encoding </span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">encoding =</span> <span class="st">"UTF-8"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="credentials" class="level2">
<h2 class="anchored" data-anchor-id="credentials">Credentials</h2>
<p>To query the Facebook Marketing API requires creating an account and obtaining credentials. This process for obtaining credentials is fairly straightforward (see <a href="https://worldbank.github.io/rsocialwatcher/articles/create_facebook_credentials.html">instruction here</a>) — feel free to give it a shot outside of the lab, if you’re interested. Here, we’ll use existing credentials.</p>
<p>We’ll need to load in some credentials before we get started. Specifically, we’ll need the:</p>
<ul>
<li>Version</li>
<li>Token</li>
<li>Creation account</li>
</ul>
<p>We can load these from a separate credentials script. You’ll need to update the script with the correct path to your credentials.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## give path to credentials file</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"../private/credentials.R"</span>) </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="do">#### Alternatively, directly supply credentials </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># VERSION = "enter-version"</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># CREATION_ACT = "creation_act"</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># TOKEN = "enter-token"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="basic-query-of-fb-marketing-api" class="level1">
<h1>Basic query of FB Marketing API</h1>
<p>To query the Facebook Marketing API using the <code>rsocialwatcher</code> package, the main function we’ll use is: <code>rsocialwatcher::query_fb_marketing_api().</code> The package also has lots of other functions as well — to learn more, see the <a href="https://worldbank.github.io/rsocialwatcher/index.html">package website</a>.</p>
<p>First, we can use the help to learn more about the function using the built in documentation figure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>?query_fb_marketing_api</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This function clearly has lots of arguments, but let’s focus on the basic functionality for now. Here’s the code to query all FB users in Great Britain between the ages of 18 and 65.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## All Facebook users in Great Britain between ages of 18 and 65 </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>fb_mau_users <span class="ot">&lt;-</span> <span class="fu">query_fb_marketing_api</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">location_unit_type =</span> <span class="st">"countries"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">location_keys =</span> <span class="st">"GB"</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_min =</span> <span class="dv">18</span>, </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_max =</span> <span class="dv">65</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">version =</span> VERSION,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">creation_act =</span> CREATION_ACT,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">token =</span> TOKEN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fb_mau_users</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  estimate_dau estimate_mau_lower_bound estimate_mau_upper_bound
1     47009608                 48100000                 56600000
  location_unit_type location_types location_keys gender age_min age_max
1          countries home or recent            GB 1 or 2      18      65
    api_call_time_utc
1 2025-01-20 13:34:05</code></pre>
</div>
</div>
<section id="interpreting-output" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-output">Interpreting output</h2>
<p>There’s lots of different columns here. Let’s focus on the most important ones:</p>
<ul>
<li><p><strong><code>estimate_dau</code></strong> = number of daily active users</p></li>
<li><p><strong><code>estimate_mau_lower_bound</code></strong> = lower bound estimate of monthly active users</p></li>
<li><p><strong><code>estimate_mau_upper_bound</code></strong> = upper bound estimate of monthly active users</p></li>
<li><p><strong><code>location_keys</code></strong> = country code (2-letter)</p></li>
<li><p><code>Gender</code> (1 = male, 2 = female)</p></li>
<li><p><code>age_min</code> = minimum age</p></li>
<li><p><code>age_max</code> = maximum age</p></li>
</ul>
<p>For simplicity, we’ll focus on <strong><code>estimate_mau_upper_bound</code></strong> for the rest of this lab. This is more stable than the daily active users, which has more day-to-day fluctuations.</p>
</section>
<section id="exercise-1" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1">Exercise 1</h2>
<ul>
<li><p>1.1 How many FB monthly active users are in France between the age of 18 and 65? (Use the <strong><code>estimate_mau_upper_bound</code></strong> column.)</p></li>
<li><p>1.2 How many FB monthly active users in Great Britain are between the ages of 40 and 50? Is this more or less than the number of monthly active users between 30 and 40?</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">## exercise 1.1 </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="do">## exercise 1.2 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sending-multiple-queries" class="level2">
<h2 class="anchored" data-anchor-id="sending-multiple-queries">Sending multiple queries</h2>
<p>There are several useful ways to query data for multiple countries, genders, etc. at once.</p>
<ul>
<li><p>The <code>map_param</code> function allows you to specify multiple countries, genders, etc. at the same time. This will return multiple rows.</p></li>
<li><p>In contrast, including a vector — e.g., <code>c("US", "MX", "CA")</code> — returns MAU counts for all countries pooled together</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Query users by gender in US, MX, and CA</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">query_fb_marketing_api</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">location_unit_type =</span> <span class="st">"countries"</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">location_keys =</span> <span class="fu">map_param</span>(<span class="st">"US"</span>, <span class="st">"MX"</span>, <span class="st">"CA"</span>),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">gender =</span> <span class="fu">map_param</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_min =</span> <span class="dv">13</span>, </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_max =</span> <span class="dv">65</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">version =</span> VERSION,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">creation_act =</span> CREATION_ACT,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">token =</span> TOKEN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  estimate_dau estimate_mau_lower_bound estimate_mau_upper_bound
1     99163441                112900000                132800000
2     40055496                 46300000                 54500000
3     12218318                 13400000                 15800000
4    123156991                128300000                151000000
5     45634032                 49900000                 58700000
6     14577350                 15000000                 17600000
  location_unit_type location_types location_keys gender age_min age_max
1          countries home or recent            US      1      13      65
2          countries home or recent            MX      1      13      65
3          countries home or recent            CA      1      13      65
4          countries home or recent            US      2      13      65
5          countries home or recent            MX      2      13      65
6          countries home or recent            CA      2      13      65
    api_call_time_utc
1 2025-01-20 13:34:05
2 2025-01-20 13:34:05
3 2025-01-20 13:34:06
4 2025-01-20 13:34:06
5 2025-01-20 13:34:06
6 2025-01-20 13:34:07</code></pre>
</div>
</div>
</section>
</section>
<section id="investigate-age-patterns" class="level1">
<h1>Investigate age patterns</h1>
<p>Next, let’s investigate age patterns. We’ll have to do this separately for each age group (<code>map_param</code> doesn’t quite work here.)</p>
<p>Rather than writing out the same query (with different ages) lots of times, we’ll use a for loop. Spend a minute trying to follow the logic here before running the code!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Define the age groups of interest </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>age_groups <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">19</span>),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">24</span>),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">29</span>),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">34</span>),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">35</span>, <span class="dv">39</span>),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">44</span>),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">49</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Create an empty list to store results</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each age group and query the API</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(age_groups)) {</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="do">## </span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  age_min <span class="ot">&lt;-</span> age_groups[[i]][<span class="dv">1</span>]</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  age_max <span class="ot">&lt;-</span> age_groups[[i]][<span class="dv">2</span>]</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Query the API for the current age group</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  results[[i]] <span class="ot">&lt;-</span> <span class="fu">query_fb_marketing_api</span>(</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">location_unit_type =</span> <span class="st">"countries"</span>,</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">location_keys =</span> <span class="fu">map_param</span>(<span class="st">"IN"</span>),</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">map_param</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="co"># Both genders</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_min =</span> age_min,</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_max =</span> age_max,</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">version =</span> VERSION,</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">creation_act =</span> CREATION_ACT,</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">token =</span> TOKEN</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all results into a single dataframe (if needed)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>india_age_mau <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="visualization-monthly-active-user-age-patterns" class="level2">
<h2 class="anchored" data-anchor-id="visualization-monthly-active-user-age-patterns">Visualization monthly active user age patterns</h2>
<p>Now let’s visualize age patterns in FB MAU user in India. Before running the code below, take make some prediction about the age groups you anticipate will have the most monthly active users.</p>
<p>First, we’ll need to create a variable corresponding to the age category. We’ll also convert the gender variable from numeric to character (1 = “men”, 2 = “women”).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create age categories variable from age_min and age_max variables  </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>india_age_mau <span class="ot">&lt;-</span> india_age_mau <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_range =</span> <span class="fu">paste0</span>(<span class="st">"["</span>, age_min, <span class="st">","</span>, age_max, <span class="st">"]"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    gender <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Men"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    gender <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Women"</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We’ll create two data visualizations to gain insight into the relationship between age/gender and FB usage. The first visualization is a basic plot you might make for yourself when you’re doing some quick exploratory data analysis. The second is a more polished figure that you might include in a paper.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Basic plot </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>india_age_mau <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age_range, <span class="at">y =</span> estimate_mau_upper_bound, <span class="at">color =</span> gender, <span class="at">group =</span> gender)) <span class="sc">+</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="css_lab1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fancy plot </span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>india_age_mau <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age_range, <span class="at">y =</span> estimate_mau_upper_bound, <span class="at">color =</span> gender, <span class="at">group =</span> gender)) <span class="sc">+</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Thicker lines for clarity</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">stroke =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Hollow points with white fill</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(india_age_mau<span class="sc">$</span>estimate_mau_upper_bound))) <span class="sc">+</span> </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age Category"</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"FB Monthly Active Users"</span>,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Gender"</span>,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"India: Facebook MAU by Age/Gender"</span>) <span class="sc">+</span> </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="css_lab1_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exercise-2" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2">Exercise 2</h2>
<ul>
<li>2.1 Are there more women or men FB monthly active users in India? What are some potential reasons for this digital gender gap?</li>
<li>2.2 What age group has the fewest monthly active users? Did this align with your expectation?</li>
</ul>
</section>
</section>
<section id="digital-gender-gaps" class="level1">
<h1>Digital gender gaps</h1>
<p>To what extent can Facebook tell us about gender inequality in access to the internet? In this section, we’ll first query the FB marketing API to produce gender-specific MAU counts for 11 different countries. We’ll then calculate basic FB gender gaps and benchmark this with internet digital gender gaps. Here, we’ll define a FB gender gap as:</p>
<p><span class="math display">\[
\text{FB}_{\text{Gender gap}} = \frac{\text{MAU}_{women}}{\text{MAU}_{men}}
\]</span></p>
<p>First, we’ll load data on internet gender gaps. These data comes from the <a href="https://www.digitalgendergaps.org/">Digital Gender Gaps projects</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">## internet gender gaps data </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>internet_data_gaps <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">country =</span> <span class="fu">c</span>(<span class="st">"Afghanistan"</span>,<span class="st">"Brazil"</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Democratic Republic of the Congo"</span>,<span class="st">"France"</span>,<span class="st">"India"</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Japan"</span>,<span class="st">"Nigeria"</span>,<span class="st">"Saudi Arabia"</span>,<span class="st">"Sweden"</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"United States"</span>,<span class="st">"South Africa"</span>),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">date =</span> <span class="fu">c</span>(<span class="st">"2024-11-01"</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"2024-11-01"</span>,<span class="st">"2024-11-01"</span>,<span class="st">"2024-11-01"</span>,<span class="st">"2024-11-01"</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"2024-11-01"</span>,<span class="st">"2024-11-01"</span>,<span class="st">"2024-11-01"</span>,<span class="st">"2024-11-01"</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"2024-11-01"</span>,<span class="st">"2024-11-01"</span>),</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">internet_gender_gap =</span> <span class="fu">c</span>(<span class="fl">0.472</span>,<span class="dv">1</span>,<span class="fl">0.522</span>,<span class="fl">0.99</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                          <span class="fl">0.77</span>,<span class="fl">0.955</span>,<span class="fl">0.617</span>,<span class="fl">0.995</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.96</span>),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">iso2 =</span> <span class="fu">c</span>(<span class="st">"AF"</span>,<span class="st">"BR"</span>,<span class="st">"CD"</span>,<span class="st">"FR"</span>,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"IN"</span>,<span class="st">"JP"</span>,<span class="st">"NG"</span>,<span class="st">"SA"</span>,<span class="st">"SE"</span>,<span class="st">"US"</span>,<span class="st">"ZA"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we’ll query data for each country separately by gender</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Query FB marketing api </span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>all_countries_gender <span class="ot">&lt;-</span> <span class="fu">query_fb_marketing_api</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">location_unit_type =</span> <span class="st">"countries"</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">location_keys =</span> <span class="fu">map_param</span>(<span class="st">"AF"</span>, <span class="st">"SE"</span>, <span class="st">"IN"</span>, <span class="st">"JP"</span>, <span class="st">"BR"</span>, </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"US"</span>, <span class="st">"NG"</span>, <span class="st">"SA"</span>, <span class="st">"FR"</span>, <span class="st">"ZA"</span>, <span class="st">"CD"</span>),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">gender =</span> <span class="fu">map_param</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">version =</span> VERSION,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">creation_act =</span> CREATION_ACT,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">token =</span> TOKEN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in doTryCatch(return(expr), name, parentenv, handler): Error message
from 'Facebook Marketing' API</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Too many calls, so pausing for 30 seconds then will try the query again; will only move to the next API query after the current query has successfully been called.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): Error code: 80004

Warning in value[[3L]](cond): (#80004) There have been too many calls to this
ad-account. Wait a bit and try again. For more info, please refer to
https://developers.facebook.com/docs/graph-api/overview/rate-limiting#ads-management.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.
No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
</div>
<p>Now we need to manipulate our data so it’s in the right form for our analysis. Recoding, reshaping, and merging data is often one of the most important and time consuming steps in any data analysis project.</p>
<p>Take a minute to try to understand what each line is doing before running it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="do">## recode gender </span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>all_countries_gender <span class="ot">&lt;-</span> all_countries_gender <span class="sc">%&gt;%</span> </span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender_recode =</span> <span class="fu">case_when</span>(</span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a>    gender <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"male"</span>,</span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a>    gender <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"female"</span></span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb272-7"><a href="#cb272-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-8"><a href="#cb272-8" aria-hidden="true" tabindex="-1"></a><span class="do">## reshape data from long to wide </span></span>
<span id="cb272-9"><a href="#cb272-9" aria-hidden="true" tabindex="-1"></a>all_countries_gender_wide <span class="ot">&lt;-</span> all_countries_gender <span class="sc">%&gt;%</span> </span>
<span id="cb272-10"><a href="#cb272-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(location_keys, gender_recode, estimate_mau_upper_bound) <span class="sc">%&gt;%</span> </span>
<span id="cb272-11"><a href="#cb272-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> gender_recode, <span class="at">values_from =</span> estimate_mau_upper_bound) </span>
<span id="cb272-12"><a href="#cb272-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-13"><a href="#cb272-13" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate gender ratios</span></span>
<span id="cb272-14"><a href="#cb272-14" aria-hidden="true" tabindex="-1"></a>all_countries_gender_wide <span class="ot">&lt;-</span> all_countries_gender_wide <span class="sc">%&gt;%</span> </span>
<span id="cb272-15"><a href="#cb272-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">facebook_mau_gender_ratio =</span> female<span class="sc">/</span>male) <span class="sc">%&gt;%</span> </span>
<span id="cb272-16"><a href="#cb272-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(internet_data_gaps, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"location_keys"</span> <span class="ot">=</span> <span class="st">"iso2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="visualize-results" class="level2">
<h2 class="anchored" data-anchor-id="visualize-results">Visualize results</h2>
<p>Finally, we’ll visualize our results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Basic plot </span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>all_countries_gender_wide <span class="sc">%&gt;%</span> </span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> facebook_mau_gender_ratio, <span class="at">y =</span> internet_gender_gap)) <span class="sc">+</span> </span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="css_lab1_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fancy plot </span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>all_countries_gender_wide <span class="sc">%&gt;%</span> </span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> facebook_mau_gender_ratio, <span class="at">y =</span> internet_gender_gap, <span class="at">label =</span> location_keys)) <span class="sc">+</span> </span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>() <span class="sc">+</span> </span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb274-7"><a href="#cb274-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb274-8"><a href="#cb274-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb274-9"><a href="#cb274-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Facebook MAU Gender Gap"</span>,</span>
<span id="cb274-10"><a href="#cb274-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Internet Gender Gap"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="css_lab1_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exercise-3" class="level2">
<h2 class="anchored" data-anchor-id="exercise-3">Exercise 3</h2>
<ul>
<li>3.1 Calculate the correlation between the MAU Gender Gap and the Internet Gender Gap.</li>
<li>3.2 Why might the Facebook gender gap not perfectly correlate with the internet gender gap? What other predictors might be used in conjunction with the Facebook gender gap data to predict internet gender gaps?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 3.1 </span></span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Hint: </span></span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a><span class="co"># all_countries_gender_wide %&gt;% </span></span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(cor(___, ___))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>